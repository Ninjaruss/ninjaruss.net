/* Persona 3 Reload â€” Page Transitions & Component Animations */

/* ============================================
   PAGE TRANSITIONS (View Transitions API)
   P3R uses clean diagonal wipe/sweep effects
   ============================================ */

/* Custom page transition: Diagonal Sweep */
@keyframes p3r-sweep-out {
  from {
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
    opacity: 1;
  }
  to {
    clip-path: polygon(100% 0, 100% 0, 100% 100%, 100% 100%);
    opacity: 0;
  }
}

@keyframes p3r-sweep-in {
  from {
    clip-path: polygon(0 0, 0 0, 0 100%, 0 100%);
    opacity: 0;
  }
  to {
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
    opacity: 1;
  }
}

/* Subtle slide with fade - P3R style but less jarring */
@keyframes p3r-slide-in {
  from {
    transform: translateX(20px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes p3r-slide-out {
  from {
    transform: translateX(0);
    opacity: 1;
  }
  to {
    transform: translateX(-20px);
    opacity: 0;
  }
}

/* View Transition: Old page exits */
::view-transition-old(root) {
  animation: p3r-slide-out 250ms cubic-bezier(0.4, 0, 0.2, 1) both;
}

/* View Transition: New page enters */
::view-transition-new(root) {
  animation: p3r-slide-in 300ms cubic-bezier(0.0, 0, 0.2, 1) both;
}

/* Ensure smooth overlap - both layers visible during transition */
::view-transition-group(root) {
  background: var(--color-bg-deep);
}

::view-transition-image-pair(root) {
  isolation: auto;
}

::view-transition-old(root),
::view-transition-new(root) {
  mix-blend-mode: normal;
}

/* Disable animation for users who prefer reduced motion */
@reflections (prefers-reduced-motion: reduce) {
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation: none;
  }
}


/* ============================================
   COMPONENT ENTRANCE ANIMATIONS
   P3R-style staggered reveal effects
   ============================================ */

/* Base entrance animation */
@keyframes p3r-entrance {
  from {
    transform: translateY(24px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Entrance from left (for headers) */
@keyframes p3r-entrance-left {
  from {
    transform: translateX(-40px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

/* Entrance with scale (for cards) */
@keyframes p3r-entrance-scale {
  from {
    transform: translateY(20px) scale(0.96);
    opacity: 0;
  }
  to {
    transform: translateY(0) scale(1);
    opacity: 1;
  }
}

/* Wipe reveal (P3R signature effect) */
@keyframes p3r-wipe-reveal {
  from {
    clip-path: inset(0 100% 0 0);
    opacity: 0;
  }
  to {
    clip-path: inset(0 0 0 0);
    opacity: 1;
  }
}

/* Diagonal wipe reveal */
@keyframes p3r-diagonal-reveal {
  from {
    clip-path: polygon(0 0, 0 0, 0 100%, 0 100%);
  }
  to {
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
  }
}

/* Stagger delay utility classes */
.stagger-1 { --stagger-delay: 0ms; }
.stagger-2 { --stagger-delay: 50ms; }
.stagger-3 { --stagger-delay: 100ms; }
.stagger-4 { --stagger-delay: 150ms; }
.stagger-5 { --stagger-delay: 200ms; }
.stagger-6 { --stagger-delay: 250ms; }

/* P3R Entrance Animation Classes */
.p3r-animate {
  animation: p3r-entrance var(--animation-base) var(--animation-easing) backwards;
  animation-delay: var(--stagger-delay, 0ms);
}

.p3r-animate-left {
  animation: p3r-entrance-left var(--animation-base) var(--animation-easing) backwards;
  animation-delay: var(--stagger-delay, 0ms);
}

.p3r-animate-scale {
  animation: p3r-entrance-scale var(--animation-slow) var(--animation-easing) backwards;
  animation-delay: var(--stagger-delay, 0ms);
}

.p3r-animate-wipe {
  animation: p3r-wipe-reveal var(--animation-slow) var(--animation-easing) backwards;
  animation-delay: var(--stagger-delay, 0ms);
}

/* Respect reduced motion preference */
@reflections (prefers-reduced-motion: reduce) {
  .p3r-animate,
  .p3r-animate-left,
  .p3r-animate-scale,
  .p3r-animate-wipe {
    animation: none;
  }
}


/* ============================================
   GRID STAGGERED ANIMATIONS
   Cards and tiles animate in with staggered timing
   ============================================ */

/* Entry Grid (listing pages) - uses consistent 50ms stagger */
.entry-grid > * {
  animation: p3r-entrance-scale var(--animation-slow) var(--animation-easing) backwards;
}

.entry-grid > *:nth-child(1) { animation-delay: 0ms; }
.entry-grid > *:nth-child(2) { animation-delay: 50ms; }
.entry-grid > *:nth-child(3) { animation-delay: 100ms; }
.entry-grid > *:nth-child(4) { animation-delay: 150ms; }
.entry-grid > *:nth-child(5) { animation-delay: 200ms; }
.entry-grid > *:nth-child(6) { animation-delay: 250ms; }
.entry-grid > *:nth-child(7) { animation-delay: 300ms; }
.entry-grid > *:nth-child(8) { animation-delay: 350ms; }
.entry-grid > *:nth-child(n+9) { animation-delay: 400ms; }

/* Bento Grid (home page) - uses consistent 50ms stagger */
.bento-grid > * {
  animation: p3r-entrance-scale var(--animation-slow) var(--animation-easing) backwards;
}

.bento-grid > *:nth-child(1) { animation-delay: 0ms; }
.bento-grid > *:nth-child(2) { animation-delay: 50ms; }
.bento-grid > *:nth-child(3) { animation-delay: 100ms; }
.bento-grid > *:nth-child(4) { animation-delay: 150ms; }
.bento-grid > *:nth-child(5) { animation-delay: 200ms; }
.bento-grid > *:nth-child(6) { animation-delay: 250ms; }

/* Respect reduced motion preference */
@reflections (prefers-reduced-motion: reduce) {
  .entry-grid > *,
  .bento-grid > * {
    animation: none;
  }
}
