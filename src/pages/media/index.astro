---
import { getCollection } from 'astro:content';
import SplitViewLayout from '../../layouts/SplitViewLayout.astro';
import ListItem from '../../components/ListItem.astro';
import { hasMinimalContent } from '../../utils/content';

const allMedia = await getCollection('media', ({ data }) => !data.draft);
const sortedMedia = allMedia.sort((a, b) =>
  new Date(b.data.publishedAt || 0).getTime() - new Date(a.data.publishedAt || 0).getTime()
);
---

<SplitViewLayout
  title="Media"
  description="Notes on anime, manga, films, and more."
  section="media"
>
  <Fragment slot="list">
    {sortedMedia.length > 0 ? (
      sortedMedia.map((entry) => (
        <ListItem
          href={`/media/${entry.slug}`}
          slug={entry.slug}
          title={entry.data.title}
          tags={entry.data.tags}
          contentType={entry.data.content_type}
          hasMinimalContent={hasMinimalContent(entry.body)}
        />
      ))
    ) : (
      <p class="empty-state">No media entries yet.</p>
    )}
  </Fragment>
</SplitViewLayout>

<style>
  .empty-state {
    color: var(--color-muted);
    font-style: italic;
    text-align: center;
    padding: var(--space-xl);
  }
</style>
