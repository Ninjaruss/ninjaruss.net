---
import { getCollection } from 'astro:content';
import SplitViewLayout from '../../layouts/SplitViewLayout.astro';
import ListItem from '../../components/ListItem.astro';
import { hasMinimalContent } from '../../utils/content';

const allNotes = await getCollection('notes', ({ data }) => !data.draft);
const sortedNotes = allNotes.sort((a, b) =>
  new Date(b.data.publishedAt || 0).getTime() - new Date(a.data.publishedAt || 0).getTime()
);
---

<SplitViewLayout
  title="Notes"
  description="Philosophical fragments and beliefs in progress."
  section="notes"
>
  <Fragment slot="list">
    {sortedNotes.length > 0 ? (
      sortedNotes.map((entry) => (
        <ListItem
          href={`/notes/${entry.slug}`}
          slug={entry.slug}
          title={entry.data.title}
          tags={entry.data.tags}
          hasMinimalContent={hasMinimalContent(entry.body)}
        />
      ))
    ) : (
      <p class="empty-state">No notes yet.</p>
    )}
  </Fragment>
</SplitViewLayout>

<style>
  .empty-state {
    color: var(--color-muted);
    font-style: italic;
    text-align: center;
    padding: var(--space-xl);
  }
</style>
